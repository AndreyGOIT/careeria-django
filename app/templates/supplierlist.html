{% extends "index.html" %} {% block content %}

<br />
<div id="add-div"></div>
<br />

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="display-5 fw-bold" style="color: #6f42c1">Suppliers</h1>
  <button id="add-btn" class="btn btn-success btn-lg" onclick="showaddform()">
    <i class="bi bi-plus-circle"></i> Add New Supplier
  </button>
</div>

<!-- Search Form -->
<div class="card shadow-sm mb-4">
  <div class="card-body">
    <form
      method="post"
      action="{% url 'supplier_search' %}"
      class="row g-3 align-items-center"
    >
      {% csrf_token %}
      <div class="col-md-8">
        <input
          class="form-control form-control-lg"
          type="text"
          placeholder="Search suppliers by company name..."
          name="search"
        />
      </div>
      <div class="col-md-4">
        <button type="submit" class="btn btn-outline-primary btn-lg w-100">
          <i class="bi bi-search"></i> Search
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Suppliers Grid -->
<div class="row">
  {% for s in suppliers %}
  <div class="col-md-6 col-lg-4 mb-4">
    <div class="card h-100 shadow-sm border-0 supplier-card">
      <div class="card-header bg-transparent border-0">
        <h5 class="card-title fw-bold text-purple mb-0">{{ s.companyname }}</h5>
      </div>
      <div class="card-body">
        <div class="supplier-info mb-3">
          <div class="d-flex align-items-center mb-2">
            <i class="bi bi-person me-2 text-secondary mr-1"></i>
            <span class="text-muted">{{ s.contactname }}</span>
          </div>
          <div class="d-flex align-items-center mb-2">
            <i class="bi bi-telephone me-2 text-secondary mr-1"></i>
            <span class="text-muted">{{ s.phone|default:"Not provided" }}</span>
          </div>
          <div class="d-flex align-items-center mb-2">
            <i class="bi bi-envelope me-2 text-secondary mr-1"></i>
            <span class="text-muted">{{ s.email|default:"Not provided" }}</span>
          </div>
          <div class="d-flex align-items-center mb-2">
            <i class="bi bi-geo-alt me-2 text-secondary mr-1"></i>
            <span class="text-muted"
              >{{ s.address|default:"Not provided" }}</span
            >
          </div>
          {% if s.country %}
          <div class="d-flex align-items-center mb-2">
            <i class="bi bi-globe me-2 text-secondary mr-1"></i>
            <span class="text-muted">{{ s.country }}</span>
          </div>
          {% endif %}
        </div>
      </div>
      <div class="card-footer bg-transparent border-0 pt-0">
        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
          <a
            href="{% url 'supplier_edit' s.id %}"
            class="btn btn-outline-primary btn-sm me-md-2 mr-1"
          >
            <i class="bi bi-pencil"></i> Edit
          </a>
          <a
            href="{% url 'supplier_confirm_delete' s.id %}"
            class="btn btn-outline-danger btn-sm me-md-2 mr-1"
          >
            <i class="bi bi-trash"></i> Delete
          </a>
          <a
            href="{% url 'products_by_supplier' s.id %}"
            class="btn btn-outline-secondary btn-sm"
          >
            <i class="bi bi-boxes"></i> Products
          </a>
        </div>
      </div>
    </div>
  </div>
  {% empty %}
  <div class="col-12">
    <div class="card shadow-sm border-0">
      <div class="card-body text-center py-5">
        <i class="bi bi-building display-1 text-muted"></i>
        <h3 class="text-muted mt-3">No suppliers found</h3>
        <p class="text-muted">Start by adding your first supplier</p>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<!-- Add Supplier Form Template -->
<script>
  let x = `
    <div class="card shadow-lg border-0 mb-4">
        <div class="card-header bg-primary text-white">
            <h3 class="mb-0"><i class="bi bi-building-add"></i> Add New Supplier</h3>
        </div>
        <div class="card-body">
            <form method="post" action="{% url 'supplier_add' %}" class="row g-3">
                {% csrf_token %}
                <div class="col-md-6">
                    <label class="form-label fw-bold">Company Name *</label>
                    <input class="form-control" type="text" placeholder="Company name" name="companyname" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label fw-bold">Contact Person *</label>
                    <input class="form-control" type="text" placeholder="Contact person" name="contactname" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Email</label>
                    <input class="form-control" type="email" placeholder="email@example.com" name="email">
                </div>
                <div class="col-md-6">
                    <label class="form-label">Phone</label>
                    <input class="form-control" type="tel" placeholder="+358 12 345 6789" name="phone">
                </div>
                <div class="col-12">
                    <label class="form-label">Address</label>
                    <textarea class="form-control" placeholder="Full address" name="address" rows="2"></textarea>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Country</label>
                    <input class="form-control" type="text" placeholder="Country" name="country">
                </div>
                <div class="col-12">
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-success">
                            <i class="bi bi-check-circle"></i> Confirm
                        </button>
                        <button type="button" onclick="hideaddform()" class="btn btn-secondary">
                            <i class="bi bi-x-circle"></i> Cancel
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    `;

  function showaddform() {
    document.getElementById("add-div").innerHTML = x;
    document.getElementById("add-btn").style.display = "none";
    document.getElementById("add-div").scrollIntoView({ behavior: "smooth" });
  }

  function hideaddform() {
    document.getElementById("add-div").innerHTML = "";
    document.getElementById("add-btn").style.display = "inline-block";
  }
</script>

<!-- Additional CSS -->
<style>
  .form-control:focus,
  .form-select:focus {
    border-color: #6f42c1;
    box-shadow: 0 0 0 0.2rem rgba(111, 66, 193, 0.25);
  }
</style>
{% endblock %}
<!-- <h1 style="color: darkviolet">Suppliers</h1>

<button id="add-btn" class="btn btn-success btn-sm" onclick="showaddform()">
  Add new supplier
</button>

<form method="post" action="/search-suppliers/">
  {%csrf_token %}
  <input class="card-text" type="text" placeholder="search" name="search" />

  <input type="submit" value="Search" class="btn btn-success btn-sm" name="" />
</form>

{% for s in suppliers %}
<div class="card" style="width: 50rem">
  <div class="card-body">
    <h4 class="card-title">{{s.companyname}}</h4>
    <p class="card-text">
      Contact person: {{s.contactname}} | phone: {{s.phone}} | email:
      {{s.email}}
    </p>
    <p class="card-text">Address: {{s.address}} | Country: {{s.country}}</p>

    <a href="/edit-supplier-get/{{s.id}}/" class="btn btn-primary">Edit</a>
    <a href="/confirm-delete-supplier/{{s.id}}/" class="btn btn-danger"
      >Delete</a
    >
    <a href="/products-by-supplier/{{s.id}}/" class="btn btn-secondary"
      >{{s.companyname}} Products</a
    >
  </div>
</div>

{% empty %}

<div class="card" style="width: 50rem">
  <div class="card-body">
    <p class="card-text">No suppliers found in the database</p>
  </div>
</div>
{% endfor %}

<script>
  let x = `
    <h2 style="color: lightblue">Please fill in form</h2>
    
    <div class="card" style="width: 20rem;">
        <div class="card-body">
            <form method="post" action="/add-supplier/">
    
                {% csrf_token %}
                <input class="card-text" class="card-text" type="text" placeholder="companyÂ´s name" name="companyname">
                <input class="card-text" type="text" placeholder="contact person" name="contactname">
                <input class="card-text" type="text" placeholder="address" name="address">
                <input class="card-text" type="text" placeholder="phone" name="phone">
                <input class="card-text" type="text" placeholder="email" name="email">
                <input class="card-text" type="text" placeholder="country" name="country">
                <br/>
                <input type="submit" value="Confirm" class="btn btn-success btn-sm" name="">
                <input type="submit" id="hide-btn" class="btn btn-secondary btn-sm" onclick="hideaddform()" value="Cancel" name="">
            </form>
        </div>
    </div>`;

  function showaddform() {
    document.getElementById("add-div").innerHTML = x;
  }

  function hideaddform() {
    document.getElementById("add-div").innerHTML = "";
  }
</script> -->
